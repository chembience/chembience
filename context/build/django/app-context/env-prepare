#!/bin/bash
set -e

test -f .env && source .env

CUID="$(id -u)"
CGID="$(id -g)"

cp chembience.django.env .env

declare -a files=('./.env' './chembience.django.env')
for f in "${files[@]}"; do
    sed -i -e 's?@APP_HOME?'`pwd`'?' $f
    sed -i -e "s/@CHEMBIENCE_UID/${CUID}/g" $f
    sed -i -e "s/@CHEMBIENCE_GID/${CGID}/g" $f

    sed -i -e "s/@CHEMBIENCE_VERSION/${CHEMBIENCE_VERSION}/g" $f

    sed -i -e "s/@POSTGRES_RDKIT_VERSION/${POSTGRES_RDKIT_VERSION}/g" $f
    sed -i -e "s/@POSTGRES_PASSWORD/${POSTGRES_PASSWORD}/g" $f
    sed -i -e "s/@POSTGRES_USER/${POSTGRES_USER}/g" $f
done
